{"version":3,"sources":["../../src/scroll/ScrollPanel.js"],"names":["Scroll","props","context","coord","startX","startY","endX","endY","angle","translateX","translateY","maxX","maxY","scroll","refs","scrollHeight","offsetHeight","scrollWidth","offsetWidth","e","touch","targetTouches","el","pageX","pageY","touchStartTime","Date","removeClass","preventDefault","style","transform","webkitTransform","touchEndTime","timeDif","more","addClass","height","width","window","screen","children","_getStyle","_touchStart","bind","_touchMove","_touchEnd"],"mappings":"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","file":"ScrollPanel.js","sourcesContent":["import React, {Component, PropTypes} from 'react'\r\n\r\nimport ClassCore from '../utils/ClassCore'\r\n\r\nexport default class Scroll extends Component{\r\n\tconstructor(props, context) {\r\n\t\tsuper(props, context);\r\n\t\tthis.coord = {\r\n\t\t\tstartX: 0,\r\n\t\t\tstartY: 0,\r\n\t\t\tendX: 0,\r\n\t\t\tendY: 0,\r\n\t\t\tangle: 0,\r\n\t\t\ttranslateX: 0,\r\n\t\t\ttranslateY: 0,\r\n\t\t\tmaxX: 0,\r\n\t\t\tmaxY: 0,\r\n\t\t}\r\n\t}\r\n\r\n\t// 获取scrollpanel 最大偏移量X,Y\r\n\tcomponentDidMount() {\r\n\t\tlet {scroll} = this.refs;\r\n\t\tthis.coord.maxY = scroll.scrollHeight - scroll.offsetHeight;\r\n\t\tthis.coord.maxX = scroll.scrollWidth - scroll.offsetWidth;\r\n\t}\r\n\r\n\t/*\r\n\t * touchstart\r\n\t * 获取touchstart X,Y\r\n\t * 获取toushstart time\r\n\t * scroll element removeclass ease\r\n\t*/\r\n\t_touchStart(e) {\r\n\t\tlet touch = e.targetTouches[0]; \r\n\t\tlet {el} = this.refs;\r\n\r\n\t\tthis.coord.startX = touch.pageX; \r\n\t\tthis.coord.startY = touch.pageY;\r\n\r\n\t\tthis.touchStartTime = new Date();\r\n\r\n\t\tClassCore.removeClass(el, 'ease');\r\n\t}\r\n\r\n\t\r\n\t/*\r\n\t * touchmove\r\n\t * 获取touchend X,Y\r\n\t * 现在 endY\r\n\t * scroll\r\n\t*/\r\n\t_touchMove(e) {\r\n\t\te.preventDefault()\r\n\r\n\t\tlet touch = e.targetTouches[0]; \r\n\t\tlet {el} = this.refs;\r\n\r\n\t\tthis.coord.endX = touch.pageX - this.coord.startX + this.coord.translateX; \r\n\t\tthis.coord.endY = touch.pageY - this.coord.startY + this.coord.translateY; \r\n\r\n\t\t// this.coord.angle = Math.atan2(Math.abs(touch.pageY - this.coord.startY), Math.abs(touch.pageX - this.coord.startX)) * 180 / Math.PI;\r\n\r\n\t\tif(this.coord.endY > 0) {\r\n\t\t\tthis.coord.endY = 0;\r\n\t\t}\r\n\t\tif(this.coord.endY < -this.coord.maxY) {\r\n\t\t\tthis.coord.endY = -this.coord.maxY;\r\n\t\t}\r\n\r\n\t\tel.style.transform = \"translate3d(0,\" + this.coord.endY + \"px,0)\";\r\n\t\tel.style.webkitTransform = \"translate3d(0,\" + this.coord.endY + \"px,0)\"; \r\n\t}\r\n\r\n\t_touchEnd(e) {\r\n\t\tthis.touchEndTime = new Date();\r\n\t\tlet timeDif = this.touchEndTime - this.touchStartTime;\r\n\t\tif(timeDif < 300) {\r\n\t\t\tlet more = (300 - timeDif) / 50  * (this.coord.endY - this.coord.translateY);\r\n\t\t\tthis.coord.endY = this.coord.endY + more;\r\n\t\t\tif(this.coord.endY > 0) {\r\n\t\t\t\tthis.coord.endY = 0;\r\n\t\t\t}\r\n\t\t\tif(this.coord.endY < -this.coord.maxY) {\r\n\t\t\t\tthis.coord.endY = -this.coord.maxY;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet {el} = this.refs;\r\n\t\tClassCore.addClass(el, 'ease');\r\n\t\tel.style.transform = \"translate3d(0,\" + this.coord.endY + \"px,0)\";\r\n\t\tel.style.webkitTransform = \"translate3d(0,\" + this.coord.endY + \"px,0)\"; \r\n\t\tthis.coord.translateY = this.coord.endY;\r\n\t}\r\n\r\n\t//计算scrollpanel 高宽，最大为screen高宽 \r\n\t_getStyle() {\r\n\t\tlet {height, width} = this.props;\r\n\t\tif(!height) {\r\n\t\t\theight = window.screen.height;\r\n\t\t} else if(height > window.screen.height) {\r\n\t\t\theight = window.screen.height\r\n\t\t}\r\n\t\tif(!width) {\r\n\t\t\twidth = window.screen.width;\r\n\t\t} else if(height > window.screen.width) {\r\n\t\t\twidth = window.screen.width\r\n\t\t}\r\n\t\treturn {height: height, width: width}\r\n\t}\r\n\r\n\trender() {\r\n\t\tlet {children} = this.props;\r\n\t\tlet style = this._getStyle();\r\n\t\treturn (\r\n\t\t\t<div ref=\"scroll\" style={style} className=\"scroll-panel\" onTouchStart={this._touchStart.bind(this)} onTouchMove={this._touchMove.bind(this)} onTouchEnd={this._touchEnd.bind(this)}>\r\n\t\t\t\t<div ref=\"el\" className=\"con\">\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n"]}